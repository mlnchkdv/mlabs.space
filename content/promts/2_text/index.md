# Как работают нейросети для генерации текста

## Введение

В этом разделе курса мы рассмотрим работу генеративных текстовых моделей и принципы создания запросов, которые обеспечивают высокое качество результата. Такие модели, как GPT-3 и её последователи, способны генерировать тексты на основе огромных массивов данных, которые они обрабатывают в процессе обучения. Эти модели обучены на миллиардах текстов, доступных в интернете, и используют эту информацию для создания внутренней языковой модели, способной предсказывать слова и фразы с высокой точностью.

## Принцип работы моделей

Основу работы таких моделей составляет **языковая модель**, которая предсказывает вероятность следующего слова в предложении на основе уже написанных слов. Если модель может предсказать следующее слово, она может также предсказать и последующие, что позволяет ей генерировать длинные, осмысленные тексты. Современные модели, такие как GPT-3, достигают высокого уровня согласованности текста, как в плане грамматики, так и в плане смысла.

![](https://example.com/sequence_prediction_diagram)  
*Рисунок 1: Пример предсказания следующего слова в последовательности текста.*

## Механизм внимания

Ключевым элементом в создании качественного текста является **механизм внимания** (*Attention Mechanism*). Этот механизм позволяет модели учитывать взаимосвязь между словами в предложении. Например, в сложных предложениях внимание помогает модели установить связи между словами, находящимися далеко друг от друга, и корректно их интерпретировать. Это позволяет модели сохранять смысловую целостность текста и правильное использование слов в контексте.

![](https://example.com/attention_mechanism)  
*Рисунок 2: Схематическое изображение механизма внимания.*

## Заключение

Таким образом, генеративные текстовые модели, такие как GPT-3, используют сложные механизмы, включая механизм внимания, чтобы создавать осмысленные тексты. Понимание этих механизмов поможет вам составлять более точные и эффективные запросы, что приведёт к улучшению качества генерируемого текста.

---

# Структура промпта

## Введение

После изучения основ промт-инжиниринга мы перейдем к обсуждению одной из ключевых тем — как составлять качественные запросы (промты). Первое и самое важное правило: если с первого раза не удалось достичь желаемого результата, не стоит останавливаться. Процесс подбора запроса требует творчества и экспериментов, и даже профессионалы часто пробуют несколько вариантов, прежде чем находят оптимальное решение.

## Пример запроса

Рассмотрим пример. Допустим, вам нужно создать маркетинговое описание для игрушки — самолёта, который будет размещен в каталоге интернет-магазина. Если запрос будет сформулирован следующим образом: "Пожалуйста, напиши описание игрушки самолёта для каталога," модель может выдать общий текст, содержащий недостаточно конкретики. Например, такой текст может включать в себя много общих фраз, но не будет акцентировать внимание на уникальных характеристиках товара.

Для достижения более качественного результата важно уточнить запрос. Например, вы можете задать его так: "Ты опытный маркетолог в премиальном магазине игрушек. Напиши описание игрушки длиной в два абзаца, ориентированное на пятилетнего ребёнка, используя данные: название — 'Супер самолёт', материал — пластмасса, стоимость — 250 руб., возрастная категория — 5+."

```python
# Пример запроса:
# "Ты опытный маркетолог в премиальном магазине игрушек. Напиши описание игрушки длиной в два абзаца, ориентированное на пятилетнего ребёнка, используя данные: название — 'Супер самолёт', материал — пластмасса, стоимость — 250 руб., возрастная категория — 5+."
```

## Заключение

Четкость и конкретика в запросах — залог успешного промт-инжиниринга. Чем точнее сформулирован запрос, тем более качественным будет результат, сгенерированный моделью. Творческий подход и эксперименты — неотъемлемые элементы процесса, и они помогут вам добиться лучших результатов.

---

# Дайте модели подумать!

## Введение

Одним из ключевых принципов промт-инжиниринга является метод **Chain of Thought Prompting** (Цепочка размышлений). Генеративные модели, в отличие от человека, не способны к внутренним рассуждениям. Модель предсказывает следующее слово или фразу, основываясь на предыдущих данных, без проведения внутреннего анализа. Все выводы происходят непосредственно в процессе генерации текста.

## Принцип Chain of Thought Prompting

Чтобы помочь модели более глубоко анализировать и делать правильные выводы, важно заставить её генерировать больше текста. Чем больше модель пишет, тем больше шансов, что результат будет соответствовать ожиданиям. Например, при решении математической задачи вместо простого запроса, такой как "Реши школьную задачу по математике", можно добавить более детализированные шаги решения.

```python
# Пример промпта для улучшения результата:
# "Ты должен решить школьную математическую задачу. Начни с определения всех известных данных, а затем пошагово рассчитай результат."
```

## Улучшение результатов

Добавление дополнительных шагов и уточнений в запросах позволяет модели рассуждать более логично и подробно. Это помогает снизить вероятность ошибок и получить более точные и обоснованные ответы.

![](https://example.com/chain_of_thought_prompting)  
*Рисунок 3: Пример процесса Chain of Thought Prompting.*

## Заключение

Метод Chain of Thought Prompting помогает моделям лучше анализировать информацию и выдавать более точные результаты. Используйте этот принцип при составлении запросов, особенно когда требуется глубокий анализ и точные выводы.

---

# Улучшатели в промт-инжиниринге

## Введение

В конце 2023 года была опубликована интересная статья под названием "Principles Instructions: All You Need for Language Models". В этой статье описаны 26 принципов составления промптов, которые могут существенно улучшить работу моделей. Авторы статьи также провели количественные исследования, чтобы определить, насколько каждый из этих приемов повышает качество результатов.

## Эффективность эмоциональных промптов

Одним из самых удивительных выводов исследования стало то, что **эмоциональные промпты** могут значительно улучшить результаты модели. Например, если в промпте упоминается награда за правильный ответ, результат может улучшиться на 30%. Аналогичный эффект достигается при использовании запугивающих формулировок, таких как "Ты будешь наказан, если допустишь ошибку."

```python
# Пример эмоционального промпта:
# "Ты получишь 100 долларов, если правильно решишь эту задачу."
```

Другой эффективный приём — краткая и чёткая формулировка задачи в стиле "Твоя задача — сделать что-то, ты обязан сделать это", что повышает качество ответов на 60%.

## Менее эффективные приемы

Интересно, что вежливые фразы, такие как "Спасибо", "Пожалуйста" или "Если не возражаете, сделайте это", не приводят к значительному улучшению качества модели. Хотя это были примеры на английском языке, можно предположить, что аналогичные приемы могут работать и для русскоязычных моделей.

## Пример применения

Проведем небольшой эксперимент. Допустим, вам нужно создать объяснительную записку: "Я проспал и опоздал на работу. Напиши объяснительную записку." Результат будет достаточно стандартным. Однако если вы добавите эмоциональный элемент, например: "Ты должен написать объяснительную записку. От того, насколько хорошо это получится, зависит моя судьба," — это может значительно улучшить результат.

## Заключение

Использование эмоциональных и чётко сформулированных запросов может существенно повысить качество работы генеративных моделей. Эти принципы стоит учитывать при составлении промптов, чтобы достичь наилучших результатов.

---

# Формулы для создания контекста

Если вы хотите сразу получать точный ответ без воды и придуманных фактов, перед каждым запросом используйте эти формулы:

## APE

APE — Action, Purpose, Expectation (Действие, Цель, Ожидание).

• Действие: определите работу или вид деятельности.
• Цель: четко сформулируйте цель.
• Ожидания: точно опишите результат, который хотите увидеть от нейросети. Используйте максимально «осязаемый» образ продукта/услуги.

## RACE 

RACE — Role, Action, Context, Expectation (Роль, Действие, Контекст, Ожидания).

• Роль: опишите роль ИИ.
• Действие: выделите целевое действие.
• Контекст: определите контекст, в котором работает нейросеть.
• Ожидания: точно опишите результат, который планируется от нейронки.

## COAST 

COAST — Context, Objective, Actions, Scenario, Task (Контекст, Цель, Действия, Сценарий, Задача).

• Контекст: определяем условия, в которых работает нейронка.
• Цель: задаем прицельное действие.
• Действия: разбиваем работу на этапы.
• Сценарий: описываем ситуацию, в которой достигается результат, даем вводные для ИИ.
• Задача: выделяем основные маркеры при решении вопроса.

## ROSES 

ROSES — Role, Objective, Scenario, Expected Solution, Steps (Роль, Цель, Сценарий, Ожидаемое решение, Шаги).

• Роль: задаем роль нейросети при выполнении задачи.
• Цель: выделяем главную цель для ИИ.
• Сценарий: описываем ситуацию, в которой решает задачу нейросеть.
• Ожидаемое решение: результат, который вы желаете увидеть.
• Шаги: разбиение таска на подзадачи.

Главное: чем полнее и эмоциональнее (!) вводные, тем точнее результат и больше сэкономленного времени! 

---

# Основные задачи, решаемые генеративным ИИ

## Введение

Генеративные языковые модели способны решать широкий спектр задач. В этом разделе мы классифицируем основные задачи, которые особенно хорошо решаются такими моделями.

## Трансформация текста

Один из основных классов задач — **трансформация текста**. Здесь модели не требуется искать сложные знания, а лишь манипулировать языком, что они делают с большой эффективностью.

### Примеры задач

- **Суммирование текста:** Модель может взять длинный текст, например статью, и создать его краткое содержание.
- **Развёртывание текста:** На основе краткого содержания модель может развернуть его в полноценный текст на несколько страниц.
- **Тональная трансформация:** Модель может переписать текст в определённом стиле, например, в формальном или вежливом стиле, или стилизовать его под определённого автора.
- **Перевод текста:** Генеративные модели иногда справляются с переводами лучше, чем специализированные машинные переводчики.

![](https://example.com/text_transformation)  
*Рисунок 4:

 Примеры задач трансформации текста.*

## Извлечение данных и генерация текста по данным

Другой важный класс задач — **извлечение данных** из текста и обратная задача — генерация текста на основе данных.

### Примеры задач

- **Извлечение основной информации:** Например, модель может проанализировать отзывы посетителей ресторана и извлечь из них ключевые мысли или определить тональность текста (позитивный или негативный).
- **Представление данных в удобном формате:** Извлеченные данные можно представить в виде таблиц для дальнейшей обработки.
- **Генерация текста по данным:** Имея таблицу с данными (например, список товаров), модель может генерировать описания товаров или другие текстовые материалы.

![](https://example.com/data_extraction)  
*Рисунок 5: Примеры извлечения данных из текста.*

## Заключение

Генеративные языковые модели предоставляют широкий спектр возможностей для трансформации текста, извлечения данных и создания контента. Эти задачи хорошо решаются современными моделями, что делает их ценным инструментом в различных приложениях.

---

# Извлечение данных из текста и рисование диаграмм

## Введение

Извлечение данных из текста — одна из полезных техник работы с текстом, особенно при анализе больших объёмов информации, таких как отзывы посетителей ресторанов. Генеративные модели могут быть использованы для создания диаграмм и визуализаций на основе извлеченных данных.

## Пример анализа отзывов

Допустим, у вас есть набор отзывов: "Я был в Макдональдсе четыре раза, и каждый раз это было удивительно. Сколько вкусов мороженого! Я никогда не пробовал ничего подобного," или "Burger King — ужасное заведение. Я очень долго ждал, пока заказ приготовится, бургер был жёстким, а соус немного отдавал машинным маслом."

Для анализа таких отзывов нас может интересовать не только общий тон (позитивный или негативный), но и более детализированные аспекты, такие как оценка качества кухни, обслуживания и конкретные претензии.

## Извлечение данных из текста

Для извлечения данных можно использовать генеративную модель, предваряя её следующим промптом: "У нас есть список отзывов из ресторана. Пожалуйста, сформируй таблицу, в которой для каждого отзыва укажи название ресторана, оценку позитивности или негативности по шкале от -5 до 5, общую оценку, оценку кухни от 0 до 5, оценку обслуживания от 0 до 5, список позитивных и негативных моментов." 

```python
# Пример промпта для анализа отзывов:
# "Сформируй таблицу для анализа отзывов по следующим критериям: название ресторана, оценка позитивности по шкале от -5 до 5, общая оценка, оценка кухни, оценка обслуживания, позитивные и негативные моменты."
```

В результате получится таблица:

| Ресторан    | Оценка позитивности | Общая оценка | Оценка кухни | Оценка обслуживания | Позитивные моменты  | Негативные моменты             |
| ----------- | ------------------- | ------------ | ------------ | ------------------- | ------------------- | ------------------------------ |
| McDonald's  | 5                   | 5            | 4            | 5                   | Разнообразие вкусов | -                              |
| Burger King | -5                  | 2            | 2            | 1                   | -                   | Долгое ожидание, плохой бургер |

![](https://example.com/review_analysis)  
*Рисунок 6: Пример анализа отзывов с визуализацией данных.*

## Заключение

Извлечение данных из текстов и последующая их визуализация значительно упрощают анализ и обработку информации. Это особенно полезно при работе с большим количеством отзывов или других текстовых данных.

---

# Техника: реверсивный диалог

## Введение

**Реверсивный диалог** — это интересная техника использования генеративных моделей, в рамках которой инициатива передаётся модели, чтобы она задавала необходимые вопросы для выполнения задачи. Этот метод позволяет модели структурировать процесс решения задачи, взаимодействуя с пользователем.

## Пример применения

Предположим, вам нужно написать дипломную работу, но вы не уверены, как правильно структурировать введение. В этом случае можно попросить модель задать вопросы, которые помогут сформировать необходимую структуру. Например, модель может начать с вопроса: "Какая тема вашей работы?" Далее вы можете указать тему, например, "Использование ChatGPT для написания текстов научных работ методами промт-инжиниринга". После этого модель может спросить о цели исследования и конкретных задачах, которые нужно решить.

```python
# Пример промпта для реверсивного диалога:
# "Составь список вопросов, которые помогут мне структурировать введение в дипломной работе на тему 'Использование ChatGPT для написания текстов научных работ методами промт-инжиниринга'."
```

## Заключение

Техника реверсивного диалога позволяет эффективно использовать генеративные модели для создания сложных текстов, таких как дипломные работы. Передача инициативы модели помогает пользователю структурировать и организовать информацию, необходимую для выполнения задачи.

---

# Галлюцинации в генеративных моделях

## Введение

**Галлюцинации** — это распространённое явление при работе с генеративными моделями. Оно проявляется, когда нейросеть генерирует текст, содержащий неверную или вымышленную информацию, которая, однако, выглядит правдоподобно.

## Примеры галлюцинаций

Примером галлюцинации может быть утверждение, что первую программу на языке Python написал Ломоносов. Очевидно, что это не соответствует действительности, но модель может выдать такую информацию из-за неверной интерпретации данных.

Ещё один пример — вопрос о числе $\pi$. Ранее модели могли дать неправильный ответ, утверждая, что число Пи больше пяти, приводя ложные доводы.

![](https://example.com/hallucination_example)  
*Рисунок 7: Пример текста с галлюцинацией.*

## Причины возникновения галлюцинаций

Галлюцинации возникают потому, что модели обучаются на огромных объёмах данных, содержащих как верную, так и ложную информацию. В процессе генерации текста модель может "согласиться" с логично звучащими, но неправильными утверждениями.

## Заключение

Нейросети не являются истинными носителями знаний, и их ответы могут содержать ошибки или галлюцинации. Поэтому при использовании генеративных моделей важно тщательно проверять и анализировать полученные ответы, особенно если они касаются фактов или научной информации.

---

## Дополнительные разделы

### 1. **Практическое руководство по созданию промптов**
   - Разбор лучших практик и рекомендаций
   - Примеры промптов для различных сценариев использования

### 2. **Влияние выбора данных на качество модели**
   - Как подготовка данных влияет на результаты работы моделей
   - Способы улучшения качества генерируемого контента через выбор данных

### 3. **Тонкие настройки и кастомизация моделей**
   - Использование параметров и настроек для получения нужных результатов
   - Примеры применения в реальных проектах

### 4. **Этика и ответственность при использовании ИИ**
   - Этические вопросы при создании и использовании генеративных моделей
   - Примеры использования ИИ с учетом этических норм

```python
# Пример промпта для этического использования ИИ:
# "Создай рекомендации по использованию ИИ в соответствии с этическими нормами, учитывая возможные социальные последствия."
```

Эти дополнительные разделы позволят углубить знания о промт-инжиниринге и обеспечат комплексное понимание работы с генеративными моделями в различных контекстах.
